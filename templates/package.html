<%inherit file="base.html"/>

<%def name="crumbs()">
 &middot; <a href="/packages">packages</a>
 &middot; <a href="/package/${package}">${package}</a>
 &middot; <span>${branch}</span>
</%def>

<%def name="display(pkg, name)">
  % if name in pkg:
  <li>
    <strong>${name.capitalize()}</strong>

    % if hasattr(pkg[name], "__iter__"):
      <ul>
        % for elem in pkg[name]:
        <li>${elem}</li>
        % endfor
      </ul>
    % else:
      <span>${pkg[name] | h}</span>
    % endif
  </li>
  % endif
</%def>

<%def name="title()">
Package ${package}/${branch}
</%def>

<%def name="content()">
<header>
  <h1>Package ${package}/${branch}</h1>
</header>

<nav>
<ul>
  <li><a href="/package/${package}/${branch}/log">Package Changelog</a></li>
</ul>
</nav>

<section>
  <ul class="infolist">
    %if "website" in pkg:

    ${display(pkg, "name")}

    <li><strong>Website</strong>
    <a href="${pkg['website']}">${pkg['website']}</a>
    % endif

    ${display(pkg, "version")}
    ${display(pkg, "release")}
    ${display(pkg, "licenses")}
    ${display(pkg, "architectures")}

    % if "dependencies" in pkg:
    <li><strong>Dependencies</strong>
    <ul class="deplist">
     % for dep in pkg["dependencies"]:
      % if len(dep) > 1:
      <li><a href="/package/${dep[0] | h}">${dep[0] | h} ${dep[1] | h}
      ${dep[2] | h}</a></li>
      % else:
      <li><a href="/package/${dep[0] | h}">${dep[0] | h}</a></li>
      % endif
     % endfor
    </ul>
    % endif

    % if "build-dependencies" in pkg:
    <li><strong>Build Dependencies</strong>
    <ul class="builddeplist">
     % for dep in pkg["build-dependencies"]:
      % if len(dep) > 1:
      <li><a href="/package/${dep[0] | h}">${dep[0] | h} ${dep[1] | h}
      ${dep[2] | h}</a></li>
      % else:
      <li><a href="/package/${dep[0] | h}">${dep[0] | h}</a></li>
      % endif
     % endfor
    </ul>
    % endif
  </ul>
<section>

<section class="description">
  ${pkg["description"] if "description" in pkg else "No description..." | h}
</section>

<section class="files">
<h1>Files</h1>
<ul>
  % for file in files:
  <li>
    <a href="/package/${package}/${branch}/file/${file | h}">${file | h}</a>
  </li>
  % endfor
</ul>
</section>

<section class="download_source">
<h1>Download Source</h1>
<ul>
  <li>
    <a href="/source/${package}-${branch}.tar.gz">
      ${package}-${branch}.tar.gz</a>
  </li>
  <li>
    <a href="/source/${package}-${branch}.tar.bz2">
      ${package}-${branch}.tar.bz2</a>
  </li>
</ul>
</section>

<section class="sources">
<h1>Sources</h1>
<ul>
  % if "sources" in pkg:
   % for source in pkg["sources"]:
    % if any(source.startswith(prefix) for prefix in ("http://", "ftp://")):
      <li><a href="${source | h}">${source | h}</a></li>
    % else:
      <li><a href="/package/${package}/${branch}/file/${source | h}">${source | h}</a></li>
    %endif
   % endfor
  % endif
</ul>
</section>

</%def>
